@model Igt.WebConsola.Base.Models.BitacoraModel

@{
    ViewData["Title"] = "Mostrar";
}

<h2>Bitacora de transacciones en intermedia</h2>


<hr />
<h4>Seleccione los filtros a utilizar.</h4>
@using (Html.BeginForm("Mostrar", "Bitacora", FormMethod.Get))
{
    @Html.AntiForgeryToken()

<div class="form-horizontal">
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    <div class="form-group">
        <div class="panel panel-default">
            <div class="panel-heading">Por Tipos</div>
            <div class="panel-body">
                <div class="text-right">
                    @Html.LabelFor(x => Model.TipoObjeto, "Tipo de objeto:", htmlAttributes: new { @class = "control-label col-md-1" })
                </div>
                <div class="col-md-3">
                    <select asp-for="TipoObjeto" class="selectpicker form-control"
                            data-style="btn btn-outline-secondary btn-outline"
                            data-menu-style="dropdown-blue">
                            @if (Model?.TiposObjetos != null)
                            {
                                foreach (var item in Model.TiposObjetos)
                                {
                                    <option value="@item.Value">@item.Text</option>
                                }
                            }
                            else
                            {
                                <option disabled selected>Sin opciones disponibles</option>
                            }

                    </select>
                </div>
                <div class="text-right">
                    @Html.LabelFor(x => Model.TipoOperacion, "Tipo de operación:", htmlAttributes: new { @class = "control-label col-md-1" })
                </div>
                <div class="col-md-3">
                    @Html.DropDownListFor(model => model.TipoOperacion, new SelectList(
                           new List<Object>{
                                new { value = "Todos" , text = "Todos"  },
                                new { value = "Crear" , text = "Crear" },
                                new { value = "Actualizar", text = "Actualizar"}
                             },
                           "value",
                           "text",
                            "Todos"),  new { @class = "form-control col-md-1" })
                </div>
                <div class="text-right">
                    @Html.LabelFor(x => Model.TipoTransaccion, "Tipo de Transacción:", htmlAttributes: new { @class = "control-label col-md-1" })
                </div>
                <div class="col-md-3">
                    @Html.DropDownListFor(model => model.TipoTransaccion, new SelectList(
                           new List<Object>{
                                new { value ="Todos" , text = "Todos"  },
                                new { value = "SAP"  , text = "SAP" },
                                new { value = "Intermedia" , text = "Intermedia"}
                             },
                           "value",
                           "text",
                            "Todos"), new { @class = "form-control col-md-1" })
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Por Resultados</div>
            <div class="panel-body">
                <div class="text-right">
                    @Html.LabelFor(x => Model.ResultadoTransaccion, "Resultado de la Transaccion:", htmlAttributes: new { @class = "control-label col-md-1" })
                </div>
                <div class="col-md-3">
                    @Html.DropDownListFor(model => model.ResultadoTransaccion, new SelectList(
                           new List<Object>{
                                new { value = "Todos" , text = "Todos"  },
                                new { value = "Fallido" , text = "Fallido" },
                                new { value = "Exitoso" , text = "Exitoso"}
                             },
                           "value",
                           "text",
                            "Todos"), new { @class = "form-control col-md-1" })
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Por Fechas</div>
            <div class="panel-body">
                <div class="text-right">
                    @Html.LabelFor(x => Model.FechaDesde, "Desde:", htmlAttributes: new { @class = "control-label col-md-1" })
                </div>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.FechaDesde, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.FechaDesde, "", new { @class = "text-danger" })
                </div>
                <div class="text-right">
                    @Html.LabelFor(x => Model.FechaHasta, "Hasta:", htmlAttributes: new { @class = "control-label col-md-1" })
                </div>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.FechaHasta, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.FechaHasta, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-12">
                <input type="submit" value="Mostrar" formaction="Mostrar" class="btn btn-primary btn-lg" />
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Resultados</div>
            <div class="panel-body">
                <table id="example" class="table table-striped table-bordered" data-pagination="true"
                       data-id-field="name"
                       data-page-list="[5, 10, 25, 50, 100, ALL]"
                       data-page-size="5">
                    <thead>
                        <tr>
                            <th scope="col">Correlativo</th>
                            <th scope="col">Tipo Objeto</th>
                            <th scope="col">Codigo Error</th>
                            <th scope="col">Mensaje</th>
                            <th scope="col">Fecha</th>
                            <th scope="col">Resultado</th>
                            <th scope="col">ID Objeto SAP</th>
                            <th scope="col">ID Objeto Intermedia</th>
                            <th scope="col">Tipo Transaccion</th>
                            <th scope="col">Tipo Operacion</th>
                        </tr>
                    </thead>
                    <tbody>
                            @if (Model?.datosBitacoras != null && Model.datosBitacoras.Any())
                            {
                                foreach (var item in Model.datosBitacoras)
                                {
                                    <tr>
                                        <td>@Html.DisplayFor(modelItem => item.Correlativo)</td>
                                        <td>@Html.DisplayFor(modelItem => item.TipoObjeto)</td>
                                        <td>@Html.DisplayFor(modelItem => item.CodigoError)</td>
                                        <td>@Html.DisplayFor(modelItem => item.Mensaje)</td>
                                        <td>@Html.DisplayFor(modelItem => item.Fecha)</td>
                                        <td>@Html.DisplayFor(modelItem => item.Resultado)</td>
                                        <td>@Html.DisplayFor(modelItem => item.IDObjetoSap)</td>
                                        <td>@Html.DisplayFor(modelItem => item.IDObjetoIntermedia)</td>
                                        <td>@Html.DisplayFor(modelItem => item.TipoTransaccion)</td>
                                        <td>@Html.DisplayFor(modelItem => item.TipoOperacion)</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="10" class="text-center">No hay resultados en la bitácora</td>
                                </tr>
                            }

                    </tbody>
                </table>
            </div>
        </div>
        <p></p>
    </div>
 </div>

}
